import {
  OpenSecureChannelRequest,
  RequestHeader,
  MessageSecurityModeNone
} from './generated'
import run from './run'

describe('OpenSecureChannelRequest', () => {
  run([
    {
      name: 'normal',
      instance: new OpenSecureChannelRequest({
        RequestHeader: new RequestHeader({
          Timestamp: new Date(Date.UTC(1601, 0, 1, 0, 0, 0, 0))
        }),
        SecurityMode: MessageSecurityModeNone,
        RequestedLifetime: 600000
      }),
      // prettier-ignore
      bytes: new Uint8Array([
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0xff, 0xff, 0xff, 0xff, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00,
        0x00, 0xff, 0xff, 0xff, 0xff, 0xc0, 0x27, 0x09,
        0x00
      ])
    }
  ])
})
